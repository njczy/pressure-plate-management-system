import React, { ReactNode } from 'react';
import './HeaderBar.css';

// 内置一比一 SVG 图标（与原 MainLayout 保持一致）
const WorkIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" aria-label="工作台">
    <g transform="translate(-64 -64)">
      <path d="M87.4,217.6H64.6a.6.6,0,1,0,0,1.2H87.4a.6.6,0,1,0,0-1.2ZM68.2,198.4a.6.6,0,0,0-.6.6v10.8a.6.6,0,0,0,.6.6h3.6a.6.6,0,0,0,.6-.6V199a.6.6,0,0,0-.6-.6Zm3,10.8H68.8v-9.6h2.4ZM84.4,199a.586.586,0,0,0-.568-.6H74.768a.588.588,0,0,0-.568.6v3.6a.586.586,0,0,0,.568.6h9.067a.588.588,0,0,0,.568-.6V199Zm-1.2,3H75.4v-2.4h7.8Zm-8.4,3a.642.642,0,0,0-.6.675v4.05a.642.642,0,0,0,.6.675h3a.642.642,0,0,0,.6-.675v-4.05a.642.642,0,0,0-.6-.675Zm2.4,4.2H75.4v-3h1.8Zm6.6-4.2h-3a.642.642,0,0,0-.6.675v4.05a.642.642,0,0,0,.6.675h3a.642.642,0,0,0,.6-.675v-4.05A.642.642,0,0,0,83.8,205Zm-.6,4.2H81.4v-3h1.8Z" transform="translate(0 -130.8)" fill="#0d867f"/>
      <path d="M87.4,68.8a.6.6,0,0,0,.6-.6v-3A1.2,1.2,0,0,0,86.8,64H65.2A1.2,1.2,0,0,0,64,65.2V82a1.2,1.2,0,0,0,1.2,1.2H86.8A1.2,1.2,0,0,0,88,82V73a.6.6,0,1,0-1.2,0v8.4a.6.6,0,0,1-.6.6H65.8a.6.6,0,0,1-.6-.6V65.8a.6.6,0,0,1,.6-.6H86.2a.6.6,0,0,1,.6.6v2.4A.6.6,0,0,0,87.4,68.8Z" fill="#0d867f"/>
    </g>
  </svg>
);

const AppsIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 23.991 24" width="24" height="24" aria-label="应用库">
    <path d="M844.621,150.542a5.763,5.763,0,0,1-5.761-5.763v-5.212a.55.55,0,0,1,.55-.55h5.211a5.763,5.763,0,0,1,0,11.525Zm-4.662-10.425v4.662h0a4.662,4.662,0,1,0,4.662-4.662Zm-.549,4.662h0Zm-7.264,5.744a5.751,5.751,0,1,1,0-11.5h5.2a.549.549,0,0,1,.549.55v5.2A5.758,5.758,0,0,1,832.146,150.523Zm0-10.4a4.652,4.652,0,1,0,4.653,4.652v-4.652Zm12.477-2.071h-5.2a.55.55,0,0,1-.55-.55v-5.2a5.75,5.75,0,1,1,5.752,5.753Zm-4.652-1.1h4.65a4.652,4.652,0,1,0-4.65-4.653Zm-2.622,1.1h-5.2a5.754,5.754,0,1,1,5.752-5.753v5.2A.549.549,0,0,1,837.348,138.048Zm-5.2-10.407a4.653,4.653,0,0,0,0,9.307H836.8v-4.653h0a4.654,4.654,0,0,0-4.653-4.654Z" transform="translate(-826.392 -126.542)" fill="#0d867f"/>
  </svg>
);

const MessageIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" aria-label="我的消息">
    <g transform="translate(5857.105 -253)">
      <g transform="translate(-1)">
        <path d="M66.444,86.371V65.821a.208.208,0,0,1,.208-.207H84a.208.208,0,0,1,.208.207v8.291h1.5V65.821A1.712,1.712,0,0,0,84,64.114H66.651a1.712,1.712,0,0,0-1.712,1.707v20.55a1.712,1.712,0,0,0,1.712,1.707h9.711v-1.5H66.651a.208.208,0,0,1-.208-.207Z" transform="translate(-5921.044 188.886)" fill="#0d867f"/>
        <path d="M260.484,264.381a.761.761,0,0,0,0,1.522h2.932a.761.761,0,0,0,0-1.522Zm9.18-3.356a.748.748,0,0,0-.734-.761h-8.445a.762.762,0,0,0,0,1.522h8.445a.762.762,0,0,0,0-1.522Zm5.572,12.61h-1.464v-2.461a.735.735,0,1,0-1.469,0v3.222a.748.748,0,0,0,.734.761h2.2a.761.761,0,0,0,0-1.522Z" transform="translate(-6110.234 1.76)" fill="#0d867f"/>
        <path d="M524.887,515.126a5.777,5.777,0,1,0,5.777,5.777A5.777,5.777,0,0,0,524.887,515.126Zm0,10.085A4.308,4.308,0,1,1,529.2,520.9,4.313,4.313,0,0,1,524.887,525.211Z" transform="translate(-6362.77 -249.764)" fill="#0d867f"/>
      </g>
    </g>
  </svg>
);

const SearchIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24.002 24.002" width="24" height="24" aria-label="智能检索">
    <path d="M-14638.67-1070a.052.052,0,0,1-.048-.052v-1.431a.05.05,0,0,1,.048-.052h3.777a.255.255,0,0,0,.254-.257v-3.774a.053.053,0,0,1,.052-.052h1.431a.05.05,0,0,1,.052.052v5.514a.052.052,0,0,1-.052.052Zm-18.385,0a.053.053,0,0,1-.052-.052v-5.514a.051.051,0,0,1,.052-.052h1.431a.049.049,0,0,1,.048.052v3.774a.241.241,0,0,0,.077.18.252.252,0,0,0,.181.077h3.777a.051.051,0,0,1,.052.052v1.431a.053.053,0,0,1-.052.052Zm17.855-5v0s0,0,0,0l-2.479-2.487a.265.265,0,0,0-.184-.074.258.258,0,0,0-.154.052,6.951,6.951,0,0,1-4.216,1.413,6.994,6.994,0,0,1-5.286-2.406,7.028,7.028,0,0,1,.324-9.546,6.946,6.946,0,0,1,4.958-2.064,7.031,7.031,0,0,1,4.587,1.71,7.034,7.034,0,0,1,1.022,9.5.263.263,0,0,0,.019.338l2.49,2.479a.045.045,0,0,1,.015.037.045.045,0,0,1-.015.037l-1.012,1.012s0,0,0,0a.062.062,0,0,1-.033.011A.064.064,0,0,1-14639.2-1075Zm-10.723-11.819a5.315,5.315,0,0,0-1.571,3.792,5.378,5.378,0,0,0,5.371,5.374,5.377,5.377,0,0,0,5.37-5.37,5.325,5.325,0,0,0-1.574-3.8,5.331,5.331,0,0,0-3.8-1.574h0A5.34,5.34,0,0,0-14649.922-1086.816Zm15.335-1.571a.053.053,0,0,1-.052-.048v-3.781a.254.254,0,0,0-.254-.254h-3.777a.049.049,0,0,1-.048-.048v-1.431a.05.05,0,0,1,.048-.052h5.514a.05.05,0,0,1,.052.052v5.514a.049.049,0,0,1-.052.048Zm-22.468,0a.05.05,0,0,1-.052-.048v-5.514a.051.051,0,0,1,.052-.052h5.514a.051.051,0,0,1,.052.052v1.431a.05.05,0,0,1-.052.048h-3.777a.258.258,0,0,0-.258.254v3.781a.048.048,0,0,1-.048.048Z" transform="translate(14657.106 1094)" fill="#0d867f"/>
  </svg>
);

const ThemeIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" aria-label="换肤">
    <path d="M18.412,0V1.588l4.014,3.975L20.182,7.807a1.551,1.551,0,0,0-1.063-.393,1.6,1.6,0,0,0-1.613,1.613v8.3A1.579,1.579,0,0,1,15.932,18.9H8.065a1.579,1.579,0,0,1-1.574-1.574v-8.3A1.6,1.6,0,0,0,4.878,7.411,1.683,1.683,0,0,0,3.815,7.8L1.571,5.56,5.549,1.588h.985l.039.039A6.544,6.544,0,0,0,12,4.343a6.45,6.45,0,0,0,5.43-2.715.039.039,0,0,1,.039-.039h.945V0M6.57,0H5.706A1.515,1.515,0,0,0,4.488.489L.472,4.461a1.52,1.52,0,0,0,0,2.2L2.805,8.979a1.5,1.5,0,0,0,1.024.432,1.5,1.5,0,0,0,1.01-.432h.039c.039,0,.039,0,.039.039v8.308a3.156,3.156,0,0,0,3.147,3.153h7.868a3.156,3.156,0,0,0,3.141-3.153v-8.3c0-.039,0-.039.039-.039h.039A1.5,1.5,0,0,0,20.2,9.42a1.428,1.428,0,0,0,1.01-.44l2.322-2.322a1.52,1.52,0,0,0,0-2.2L19.553.489A1.576,1.576,0,0,0,18.412,0h-.985A1.582,1.582,0,0,0,16.089.75a4.931,4.931,0,0,1-4.132,2.006A5.032,5.032,0,0,1,7.829.764,1.4,1.4,0,0,0,6.57,0Zm0,0" fill="#0d867f"/>
  </svg>
);

const NavBadge = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="280"
    height="48"
    viewBox="0 0 280 48"
    aria-label="单位与班组信息"
  >
    <path d="M8 8 H272 A8 8 0 0 1 280 16 V40 A8 8 0 0 1 272 48 H8 A8 8 0 0 1 0 40 V16 A8 8 0 0 1 8 8 Z" fill="#d4f0ee" />
    <g transform="translate(20 20) scale(0.67)">
      <path d="M37.152,27.073a6.153,6.153,0,0,0,1.841-6.6,5.487,5.487,0,0,0-10.563,0,6.156,6.156,0,0,0,1.841,6.6,9.97,9.97,0,0,0-5.865,9.234V38.3a.963.963,0,0,0,.93.992H42.087a.908.908,0,0,0,.661-.293,1.011,1.011,0,0,0,.272-.7V36.3a9.974,9.974,0,0,0-5.867-9.234v0ZM33.712,18.4A3.752,3.752,0,0,1,37.2,20.84a4.166,4.166,0,0,1-.8,4.352,3.594,3.594,0,0,1-4.091.874,3.991,3.991,0,0,1-2.322-3.682A3.863,3.863,0,0,1,33.712,18.4ZM41.158,37.3H26.266V36.3a8.012,8.012,0,0,1,3.7-6.912,7.074,7.074,0,0,1,7.491,0,8,8,0,0,1,3.7,6.912V37.3Zm0,0,1.577-10.59a5.209,5.209,0,0,0,1.022-4.732A4.84,4.84,0,0,0,40.5,18.568a.915.915,0,0,0-.719.1.951.951,0,0,0-.428.6,1,1,0,0,0,.664,1.218,2.953,2.953,0,0,1,2.056,2.651,3.019,3.019,0,0,1-1.648,2.955.91.91,0,0,0-.3.22l-.023.024a.973.973,0,0,0-.139.236,1.127,1.127,0,0,0-.055.124c-.006.022-.02.04-.027.064a.884.884,0,0,0,0,.12,1,1,0,0,0-.006.23.73.73,0,0,0,.021.114,1.033,1.033,0,0,0,.039.188.93.93,0,0,0,.723.575,5.875,5.875,0,0,1,4.214,5.778V35.3a1,1,0,0,0,.457.88.884.884,0,0,0,.948,0,1,1,0,0,0,.457-.878V33.765a8.008,8.008,0,0,0-4-7.06L41.156,37.3Z" transform="translate(-23.573 -15.878)" fill="#0d867f"/>
    </g>
    <text
      transform="translate(47 28)"
      fill="#333"
      fontSize="12"
      fontFamily="PingFangSC-Regular, PingFang SC"
      dominantBaseline="middle"
    >
      江苏电力公司
    </text>
    <g transform="translate(140 20) scale(0.67)">
      <path d="M12,0A12,12,0,1,1,0,12,12,12,0,0,1,12,0Zm.448,14.483h-.02a5.409,5.409,0,0,0-4.221,2.045A5.708,5.708,0,0,0,7.016,20.85a10.169,10.169,0,0,0,10.873-.577,5.7,5.7,0,0,0-1.233-3.737,5.41,5.41,0,0,0-4.207-2.053ZM12,1.846A10.154,10.154,0,0,0,5.165,19.509a7.472,7.472,0,0,1,4.229-6.216A4.753,4.753,0,0,1,8.178,8.146a4.511,4.511,0,0,1,8.5,0,4.753,4.753,0,0,1-1.217,5.147,7.148,7.148,0,0,1,4.173,5.4A10.153,10.153,0,0,0,12,1.846Zm.447,10.769a2.732,2.732,0,1,0-.018,0h.018Z" fill="#0d867f"/>
    </g>
    <text
      transform="translate(167 28)"
      fill="#333"
      fontSize="12"
      fontFamily="PingFangSC-Regular, PingFang SC"
      dominantBaseline="middle"
    >
      班组
    </text>
    <g transform="translate(197 23) scale(0.5)">
      <g clipPath="url(#clip-path)">
        <path d="M246.555,249.213a.659.659,0,0,1-.551.248.724.724,0,0,1-.53-.248l-4.686-4.7a.612.612,0,1,1,.866-.865l4.36,4.472,4.371-4.472a.612.612,0,1,1,.866.865Zm0,0" transform="translate(-239.609 -243.469)" fill="#666"/>
      </g>
    </g>
    <defs>
      <clipPath id="clip-path">
        <rect width="12" height="6" fill="rgba(255,255,255,0.7)" stroke="#707070" strokeWidth="1"/>
      </clipPath>
    </defs>
    <g transform="translate(218 20) scale(0.67)">
      <path d="M80.225,47.248a1.091,1.091,0,0,1,1.124-1.87,11.454,11.454,0,1,1-11.778-.007,1.091,1.091,0,1,1,1.122,1.872,9.273,9.273,0,1,0,9.532.006Zm-4.771-4.592a1.091,1.091,0,0,1,1.091,1.091v8.727a1.091,1.091,0,0,1-2.181,0V43.747A1.091,1.091,0,0,1,75.454,42.656Z" transform="translate(-63.454 -42.656)" fill="#0d867f"/>
    </g>
    <text
      transform="translate(245 28)"
      fill="#333"
      fontSize="12"
      fontFamily="PingFangSC-Regular, PingFang SC"
      dominantBaseline="middle"
    >
      退出
    </text>
  </svg>
);

const Logo = () => (
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 50" width="480" height="50" aria-label="新一代设备资产精益管理系统(PMS3.0)">
    <text transform="translate(60 34)" fill="#333" fontSize="24" fontFamily="PingFangSC-Semibold, PingFang SC" fontWeight="600">
      <tspan x="0" y="0">新一代设备资产精益管理系统</tspan>
      <tspan y="0" fontFamily="Helvetica-Bold, Helvetica" fontWeight="700">(PMS3.0)</tspan>
    </text>
    <g>
      <path d="M307.49,167.831a18.822,18.822,0,1,0,7.349,1.484,18.759,18.759,0,0,0-7.349-1.484m0-.5a19.382,19.382,0,1,1-19.382,19.382A19.385,19.385,0,0,1,307.49,167.331Z" transform="translate(-282.818 -161.37)" fill="#0d867f"/>
      <path d="M16102.291,21.588a18.18,18.18,0,0,1-10.407-3.25A18.271,18.271,0,0,1,16085.27,10a18.116,18.116,0,0,0,6.726,3.542,16.046,16.046,0,0,0,4.75,6.218,22.557,22.557,0,0,1-3.407-5.842,31.187,31.187,0,0,0,3.5.663,13.577,13.577,0,0,0,6.586,6.971,18.636,18.636,0,0,0,3.347-.518c-2.787-.85-5.26-3-7.153-6.21.521.024,1.063.037,1.606.037,7.734,0,14.522-2.535,17.716-6.615a23.7,23.7,0,0,1-7.652,3.8,29.4,29.4,0,0,1-8.3,1.157,32.414,32.414,0,0,1-4.363-.3,24.058,24.058,0,0,1-1.08-2.844,32.5,32.5,0,0,0,4.493.306c7.889,0,15.167-2.656,18.543-6.767,0-.051,0-.1,0-.154s0-.1,0-.144a18.175,18.175,0,0,1-5.358,12.926A18.177,18.177,0,0,1,16102.291,21.588Zm-6.3-9.155h0a28.982,28.982,0,0,1-3.5-1.011,25.807,25.807,0,0,1-.61-2.8,24.14,24.14,0,0,0,3.366,1.02,24.658,24.658,0,0,0,.743,2.786Zm-5.028-1.622h0c-3.378-1.477-5.815-3.478-6.865-5.633a18.547,18.547,0,0,1-.1-1.883,18.179,18.179,0,0,1,5.358-12.936A18.167,18.167,0,0,1,16102.291-15a18.2,18.2,0,0,1,12.723,5.149,18.265,18.265,0,0,1,5.508,11.594c-.052-.6-.135-1.207-.247-1.813-1.021,2.4-3.593,4.646-7.24,6.331a30.473,30.473,0,0,1-12.526,2.658,29.789,29.789,0,0,1-3.334-.186,27.5,27.5,0,0,1-.432-11.3,23.525,23.525,0,0,1,4.772-10.789c-2.55,1.8-4.6,5.063-5.766,9.193a30.01,30.01,0,0,0-.724,12.573,26.4,26.4,0,0,1-3.293-.858,27.124,27.124,0,0,1,2.1-14.206c1.949-4.3,4.86-7.262,8.2-8.337a18.221,18.221,0,0,0-6.461,1.274c-4.471,4.689-6.618,12.8-5.47,20.662a23.213,23.213,0,0,1-4.025-2.152,13.874,13.874,0,0,0,4.184,3.119,25.282,25.282,0,0,0,.707,2.9Z" transform="translate(-16077.621 22.05)" fill="#0d867f" stroke="rgba(0,0,0,0)" strokeMiterlimit="10" strokeWidth="1"/>
      <path d="M289.316,138.849l-3.225-3.114,2.879-2.982,3.2,3.087-.454.47-.157-.152-1.984,2.055.186.179-.441.457ZM288.9,133.6l-1.984,2.055,2.3,2.218,1.984-2.055-2.3-2.218Zm-.92,2.723.565-.585-.314-.3-.62.642-.357-.345,1.736-1.8.357.344-.675.7.314.3.62-.642.357.345-.165.171c.216.043.389.082.521.117l-.064.351.262-.271.371.359-1.791,1.855-.371-.359.648-.671-.471-.454-.565.585-.357-.345Zm1.574-.631.064-.351-.275.285.471.454.275-.285a3.014,3.014,0,0,0-.534-.1Zm4.465-5.965c-.052-.077-.12-.169-.2-.277l-.061-.081.714-.392a2.23,2.23,0,0,1,.226.419l1.551-.756.452.927-.624.3-.226-.463-2.6,1.27.226.463-.571.278-.452-.927,1.568-.765Z" transform="translate(-281.097 -126.53)" fill="#0d867f"/>
    </g>
  </svg>
);

export interface HeaderBarNavItem {
  key: string;
  label: string;
  icon?: ReactNode;
  badge?: number;
  active?: boolean;
}

export interface HeaderBarProps {
  logo?: ReactNode;
  navItems?: HeaderBarNavItem[];
  rightContent?: ReactNode;
  className?: string;
  showIcons?: boolean;
}

// 默认导航项（与原实现一比一）
const DEFAULT_NAV_ITEMS: HeaderBarNavItem[] = [
  { key: 'work', label: '工作台', icon: <WorkIcon />, active: true },
  { key: 'apps', label: '应用库', icon: <AppsIcon /> },
  { key: 'msg', label: '我的消息', icon: <MessageIcon />, badge: 38 },
  { key: 'search', label: '智能检索', icon: <SearchIcon /> },
  { key: 'theme', label: '换肤', icon: <ThemeIcon /> }
];

export const HeaderBar: React.FC<HeaderBarProps> = ({
  logo = <Logo />,
  navItems = DEFAULT_NAV_ITEMS,
  rightContent = <NavBadge />,
  className,
  showIcons = true
}) => {
  const classes = ['ml-header-bar', className].filter(Boolean).join(' ');

  return (
    <div className="ml-header">
      <div className={classes}>
        <div className="ml-header-left">
          <div className="ml-brand">{logo}</div>
          <div className="ml-nav-items">
            {navItems.map(item => (
              <div key={item.key} className={`ml-nav-item ${item.active ? 'active' : ''}`}>
                {showIcons && item.icon ? <span className="ml-nav-icon">{item.icon}</span> : null}
                <span className="ml-nav-label">{item.label}</span>
                {item.badge ? <span className="ml-nav-badge">{item.badge}</span> : null}
              </div>
            ))}
          </div>
        </div>
        <div className="ml-header-right">{rightContent}</div>
      </div>
    </div>
  );
};

export default HeaderBar;